webpackJsonp([1],{"/Z+N":function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,".loadingIcon{position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);z-index:-1}.demo-upload-list{display:inline-block;width:60px;height:60px;text-align:center;line-height:60px;border:1px solid transparent;border-radius:4px;overflow:hidden;background:#fff;position:relative;-webkit-box-shadow:0 1px 1px rgba(0,0,0,.2);box-shadow:0 1px 1px rgba(0,0,0,.2);margin-right:4px}.demo-upload-list img{width:100%;height:100%}.demo-upload-list-cover{display:none;position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.6)}.demo-upload-list:hover .demo-upload-list-cover{display:block}.demo-upload-list-cover i{color:#fff;font-size:20px;cursor:pointer;margin:0 2px}.banner{width:200px;height:100px}",""])},"2kbw":function(t,e,n){var a=n("muez");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("0a52182a",a,!0)},"3Y14":function(t,e,n){var a=n("/Z+N");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("533e608f",a,!0)},"6UKm":function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,".user{width:100%}",""])},"7fRy":function(t,e,n){function a(t){return n(s(t))}function s(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var i={"./af":"U5mi","./af.js":"U5mi","./ar":"70tt","./ar-dz":"V5d1","./ar-dz.js":"V5d1","./ar-kw":"8Kf6","./ar-kw.js":"8Kf6","./ar-ly":"5lAg","./ar-ly.js":"5lAg","./ar-ma":"6hZg","./ar-ma.js":"6hZg","./ar-sa":"jQS8","./ar-sa.js":"jQS8","./ar-tn":"L7Sn","./ar-tn.js":"L7Sn","./ar.js":"70tt","./az":"bt++","./az.js":"bt++","./be":"wQYm","./be.js":"wQYm","./bg":"CCLY","./bg.js":"CCLY","./bm":"aTdr","./bm.js":"aTdr","./bn":"K2H7","./bn.js":"K2H7","./bo":"MYDx","./bo.js":"MYDx","./br":"E5oa","./br.js":"E5oa","./bs":"ShN7","./bs.js":"ShN7","./ca":"/jA6","./ca.js":"/jA6","./cs":"pmLo","./cs.js":"pmLo","./cv":"zEco","./cv.js":"zEco","./cy":"FEim","./cy.js":"FEim","./da":"vjy2","./da.js":"vjy2","./de":"Uc6c","./de-at":"dDya","./de-at.js":"dDya","./de-ch":"hRzC","./de-ch.js":"hRzC","./de.js":"Uc6c","./dv":"1+G4","./dv.js":"1+G4","./el":"kMBi","./el.js":"kMBi","./en-au":"i97b","./en-au.js":"i97b","./en-ca":"1Kkq","./en-ca.js":"1Kkq","./en-gb":"JWnI","./en-gb.js":"JWnI","./en-ie":"LjSC","./en-ie.js":"LjSC","./en-nz":"V2a0","./en-nz.js":"V2a0","./eo":"a0I0","./eo.js":"a0I0","./es":"USRr","./es-do":"tOul","./es-do.js":"tOul","./es-us":"N8IG","./es-us.js":"N8IG","./es.js":"USRr","./et":"Jl3j","./et.js":"Jl3j","./eu":"QRPT","./eu.js":"QRPT","./fa":"q4/k","./fa.js":"q4/k","./fi":"olX5","./fi.js":"olX5","./fo":"MCy+","./fo.js":"MCy+","./fr":"M4ob","./fr-ca":"WUOG","./fr-ca.js":"WUOG","./fr-ch":"+LbW","./fr-ch.js":"+LbW","./fr.js":"M4ob","./fy":"REnV","./fy.js":"REnV","./gd":"2wEn","./gd.js":"2wEn","./gl":"To3L","./gl.js":"To3L","./gom-latn":"q2fo","./gom-latn.js":"q2fo","./gu":"o92n","./gu.js":"o92n","./he":"UfqB","./he.js":"UfqB","./hi":"RZzY","./hi.js":"RZzY","./hr":"Cd0N","./hr.js":"Cd0N","./hu":"JMlg","./hu.js":"JMlg","./hy-am":"8CDn","./hy-am.js":"8CDn","./id":"Ct2s","./id.js":"Ct2s","./is":"t26K","./is.js":"t26K","./it":"haPy","./it.js":"haPy","./ja":"VKuq","./ja.js":"VKuq","./jv":"6zM0","./jv.js":"6zM0","./ka":"RBGw","./ka.js":"RBGw","./kk":"HNoQ","./kk.js":"HNoQ","./km":"bMcz","./km.js":"bMcz","./kn":"cXkW","./kn.js":"cXkW","./ko":"BtUI","./ko.js":"BtUI","./ky":"N5d9","./ky.js":"N5d9","./lb":"fI6P","./lb.js":"fI6P","./lo":"UwiY","./lo.js":"UwiY","./lt":"/LqS","./lt.js":"/LqS","./lv":"Z61T","./lv.js":"Z61T","./me":"QvLz","./me.js":"QvLz","./mi":"u+XU","./mi.js":"u+XU","./mk":"NfVd","./mk.js":"NfVd","./ml":"zUFV","./ml.js":"zUFV","./mr":"d0bU","./mr.js":"d0bU","./ms":"VMLn","./ms-my":"s8vs","./ms-my.js":"s8vs","./ms.js":"VMLn","./mt":"UQe0","./mt.js":"UQe0","./my":"2XfN","./my.js":"2XfN","./nb":"Mmzd","./nb.js":"Mmzd","./ne":"624x","./ne.js":"624x","./nl":"DLoo","./nl-be":"JRFb","./nl-be.js":"JRFb","./nl.js":"DLoo","./nn":"rSKj","./nn.js":"rSKj","./pa-in":"a9aR","./pa-in.js":"a9aR","./pl":"Jv93","./pl.js":"Jv93","./pt":"8cQn","./pt-br":"a6Me","./pt-br.js":"a6Me","./pt.js":"8cQn","./ro":"+QLR","./ro.js":"+QLR","./ru":"Dx5j","./ru.js":"Dx5j","./sd":"EESZ","./sd.js":"EESZ","./se":"GIHS","./se.js":"GIHS","./si":"Natn","./si.js":"Natn","./sk":"AvTU","./sk.js":"AvTU","./sl":"x0Xd","./sl.js":"x0Xd","./sq":"sNAV","./sq.js":"sNAV","./sr":"OvpH","./sr-cyrl":"fUV8","./sr-cyrl.js":"fUV8","./sr.js":"OvpH","./ss":"dhCU","./ss.js":"dhCU","./sv":"eOzh","./sv.js":"eOzh","./sw":"oMRk","./sw.js":"oMRk","./ta":"jlhQ","./ta.js":"jlhQ","./te":"AjG4","./te.js":"AjG4","./tet":"jAbp","./tet.js":"jAbp","./th":"F3gE","./th.js":"F3gE","./tl-ph":"lxTH","./tl-ph.js":"lxTH","./tlh":"ojB5","./tlh.js":"ojB5","./tr":"F5Uk","./tr.js":"F5Uk","./tzl":"T93j","./tzl.js":"T93j","./tzm":"pnBN","./tzm-latn":"YjoS","./tzm-latn.js":"YjoS","./tzm.js":"pnBN","./uk":"FLQK","./uk.js":"FLQK","./ur":"JXCW","./ur.js":"JXCW","./uz":"KHZz","./uz-latn":"nZwI","./uz-latn.js":"nZwI","./uz.js":"KHZz","./vi":"Qu/i","./vi.js":"Qu/i","./x-pseudo":"OjVM","./x-pseudo.js":"OjVM","./yo":"DOwN","./yo.js":"DOwN","./zh-cn":"gvOa","./zh-cn.js":"gvOa","./zh-hk":"ijSq","./zh-hk.js":"ijSq","./zh-tw":"RFvw","./zh-tw.js":"RFvw"};a.keys=function(){return Object.keys(i)},a.resolve=s,t.exports=a,a.id="7fRy"},Bl8r:function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,".publishProducts{width:800px;margin:20px auto 0}.inline{display:inline-block;width:100%}.smallInput{margin-bottom:10px}.smallInput:last-child{margin:0}.smallInput .ivu-input-wrapper{width:auto}.formLabel{display:inline-block;width:80px}.w50{width:45%}.sub{text-align:center}",""])},Hlp6:function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,".classify{width:100%}.classify header{margin:0 0 10px}",""])},KGJy:function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,".index{height:100%;min-width:1366px;width:100%}.index .ivu-row-flex .ivu-row-flex{height:calc(100% - 60px)}.index .ivu-row-flex .ivu-col{-webkit-transition:all .3s;transition:all .3s}.index .ivu-row-flex .navBar,.index .ivu-row-flex .navBar .ivu-menu{height:100%}.index .ivu-row-flex .navBar .ivu-menu .logo{overflow:hidden}.index .ivu-row-flex .navBar .ivu-menu .logo span{display:block;color:#eee;font-size:24px;width:90%;height:30px;text-align:center;overflow:hidden;line-height:30px;border-radius:3px;margin:15px auto;background:#5b6270}.index .ivu-row-flex .navBar .ivu-menu .ivu-menu-item{height:60px;line-height:36px;white-space:nowrap;font-size:16px}.index .ivu-row-flex .navBar .ivu-menu .ivu-menu-item p{overflow:hidden}.index .ivu-row-flex .navBar .ivu-menu>li.active{padding-left:0;padding-right:0;text-align:center}.index .ivu-row-flex .nav{border-bottom:1px solid #eee;height:60px;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;line-height:60px}.index .ivu-row-flex .nav i{cursor:pointer;-webkit-transform:rotate(0deg);transform:rotate(0deg);-webkit-transition:-webkit-transform .3s;transition:-webkit-transform .3s;transition:transform .3s;transition:transform .3s,-webkit-transform .3s}.index .ivu-row-flex .nav i.active{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.index .ivu-row-flex .nav .avatar{text-align:right;background-color:#fff;font-size:16px;width:130px;-webkit-box-shadow:-5px 0 5px #eee;box-shadow:-5px 0 5px #eee;position:absolute;right:0;padding-right:10px}.index .ivu-row-flex .nav .avatar .ivu-dropdown{margin-right:5px}.index .ivu-row-flex .nav .openButton{-webkit-box-shadow:5px 0 10px #eee;box-shadow:5px 0 10px #eee;z-index:10;width:60px;text-align:center;background-color:#fff}.index .ivu-row-flex .viewArea{height:100%;min-width:1100px;overflow:auto;padding:10px 10px 20px}.center{background-color:#fff;position:fixed;padding:10px;bottom:0;width:100%}",""])},NHnr:function(t,e,n){"use strict";function a(t){return j.get("/admin/tags/getList",{page:t})}function s(t){var e=t.name;return j.post("/admin/tags/add",{name:e})}function i(t){return j.post("/admin/tags/edit",t)}function r(t){return j.post("/admin/tags/remove",{id:t})}function o(t){return D()(t).format("YYYY-MM-DD HH:mm:ss")}function l(t){return j.post("/admin/products/publish",t)}function c(t){return j.post("/admin/products/edit",{data:t})}Object.defineProperty(e,"__esModule",{value:!0});var u=n("XwMK"),d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},p=n("OF7X")({name:"app"},d,!1,function(t){n("eZMP")},null,null).exports,m=n("zO6J"),f=n("IlIr"),h=n.n(f),g=n("9rMa"),v=n("rVsN"),b=n.n(v),x=n("2sCs"),w=n.n(x).a.create({timeout:5e3});w.interceptors.request.use(function(t){return t},function(t){return b.a.reject(t)}),w.interceptors.response.use(function(t){var e=t.data;if(5005!==e.code)return 2e3!==e.code?b.a.reject(e):e;f.Message.error(e.msg),sessionStorage.clear(),et.push("/")},function(t){return b.a.reject(t)});var j=w,y={namespaced:!0,state:{user:""},getters:{getUser:function(t){return t.user}},actions:{login:function(t,e){var n=t.commit;return new b.a(function(t,a){(function(t){var e=t.name,n=t.pw,a="/admin/user/login";return t.isSignup&&(a="/admin/user/signup"),j.post(a,{name:e,pw:n})})(e).then(function(e){n("login",e.data),sessionStorage.user=e.data.name,t(e.msg)}).catch(function(t){a(t.msg)})})},checkLogin:function(t,e){return new b.a(function(t,n){(function(t){return j.post("/admin/user/checkLogin",{user:t})})(e).then(function(e){t(e.msg)}).catch(function(t){n(t.msg)})})}},mutations:{login:function(t,e){return t.user=e}}},k=n("Ym9J"),D=n.n(k),_=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];var s=t.fn,i=t.resolve,r=void 0===i?null:i,o=t.reject,l=void 0===o?null:o;return new b.a(function(t,e){s.apply(void 0,n).then(function(e){r&&r(e),t(e)}).catch(function(t){l&&l(t),e(t.msg)})})},M={namespaced:!0,state:{tags:[]},getters:{getTags:function(t){return t.tags}},actions:{getTags:function(t,e){var n=t.commit;return _({fn:a,resolve:function(t){n("fillTags",t.data)}},e)},add:function(t,e){t.commit;return _({fn:s},e)},edit:function(t,e){t.commit;return _({fn:i},e)},remove:function(t,e){t.commit;return _({fn:r},e)}},mutations:{fillTags:function(t,e){t.tags=e.map(function(t){return t.createTime=o(t.createTime),t})}}};u.default.use(g.a);var z=new g.a.Store({modules:{pression:y,tags:M},strict:!1}),S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login",on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.login(e)}}},[n("Card",[n("h2",[t._v("欢迎登录")]),t._v(" "),n("Form",{ref:"loginForm",attrs:{model:t.formData,rules:t.rules}},[n("FormItem",{attrs:{prop:"name"}},[n("Input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}},[n("Icon",{attrs:{slot:"prepend",type:"person"},slot:"prepend"})],1)],1),t._v(" "),n("FormItem",{attrs:{prop:"pw"}},[n("Input",{attrs:{type:"password"},model:{value:t.formData.pw,callback:function(e){t.$set(t.formData,"pw",e)},expression:"formData.pw"}},[n("Icon",{attrs:{slot:"prepend",type:"locked"},slot:"prepend"})],1)],1),t._v(" "),n("FormItem",{staticStyle:{"text-align":"right"}},[n("Button",{attrs:{type:"primary",long:"",loading:t.loading},domProps:{textContent:t._s(t.isSignup?"注册":"登录")},on:{click:t.login}}),t._v(" "),n("Button",{attrs:{type:"text",size:"small"},domProps:{textContent:t._s(t.isSignup?"返回登录":"注册一个？")},on:{click:t.signup}})],1)],1)],1)],1)},staticRenderFns:[]},$=n("OF7X")({data:function(){return{loading:!1,isSignup:!1,formData:{name:"",pw:""},rules:{user:[{required:!0,message:"Please fill in the user name",trigger:"blur"}],pw:[{required:!0,message:"Please fill in the password.",trigger:"blur"},{type:"string",min:5,message:"The password length cannot be less than 5 bits",trigger:"blur"}]}}},methods:{login:function(){var t=this;this.$refs.loginForm.validate(function(e){e?(t.$Loading.start(),t.loading=!0,t.$store.dispatch("pression/login",{name:t.formData.name,pw:t.formData.pw,isSignup:t.isSignup}).then(function(e){t.$Message.success(e),t.$Loading.finish(),t.$router.push("/index")}).catch(function(e){t.$Message.error(e),t.loading=!1,t.$Loading.error()})):t.$Message.error("input is not valid!")})},signup:function(){this.formData={user:"",pw:""},this.isSignup=!this.isSignup}}},S,!1,function(t){n("2kbw")},null,null).exports,T={data:function(){return{screenWidth:0,tagsWidth:0,translateX:0}},mounted:function(){this.screenWidth=this.$refs.screenWidth.offsetWidth,this.tagsWidth=this.$refs.tagsWidth.offsetWidth},props:{tags:{type:Array,required:!0},tagsActive:{type:Number,required:!0}},methods:{wheelTags:function(t){var e=this.tagsData,n=e.tagsWidth,a=e.screenWidth,s=e.translateX;if(n-a>s){if(0===s&&t.deltaY>80||n-a<-s&&t.deltaY<80)return;this.tagsData.translateX+=t.deltaY>80?40:-40}},closeTags:function(t){if(1===this.tags.length)return this.$Message.error("至少保留一个标签");this.tags.splice(t,1),this.$router.push("/index/"+this.tags[0].path),this.$emit("update:tagsActive",0)},linkTo:function(t,e){this.$emit("update:tagsActive",e),this.$emit("routeChange","user"),this.$router.push("/index/"+t)}}},C={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"screenWidth",staticClass:"tags"},[n("div",{ref:"tagsWidth",style:{transform:"translateX("+t.translateX+"px)"},attrs:{id:"tagList"},on:{wheel:t.wheelTags}},t._l(t.tags,function(e,a){return n("Tag",{key:e.path,attrs:{type:"dot",color:t.tagsActive===a?"blue":"default",closable:""},on:{"on-close":function(e){t.closeTags(a)}},nativeOn:{click:function(n){t.linkTo(e.path,a)}}},[t._v("\n\t\t\t"+t._s(e.label)+"\n\t\t")])}))])},staticRenderFns:[]},O={data:function(){return{menuActiveName:"user",isOpen:!0,routers:[],tagsActive:0,tags:[{path:"user",label:"用户管理"}],username:sessionStorage.user}},components:{tagPages:n("OF7X")(T,C,!1,function(t){n("wQsu")},null,null).exports},watch:{$route:function(t){var e=this;this.tags.forEach(function(n,a){n.path===t.name&&(e.tagsActive=a)}),this.menuActiveName=t.name}},computed:{spanLeft:function(){return this.isOpen?3:1},spanRight:function(){return 24-this.spanLeft},title:function(){return this.isOpen?"Cap Mall":"C"},iconSize:function(){return this.isOpen?16:25},pWidth:function(){return this.isOpen?"width: 100%":"width: "+this.iconSize+"px"}},methods:{judgmentPath:function(t){return this.$route.path.substr(7)===t?"blue":"default"},cancelLogin:function(){var t=this;j.get("/admin/user/loginOut").then(function(e){sessionStorage.clear(),t.$Message.success(e.msg),t.$router.push("/")})},jumpRoute:function(t){try{throw this.tags.forEach(function(e){if(e.path===t)throw new Error}),this.tags.push({label:this.routers.find(function(e){return e.path===t}).meta.label,path:t}),new Error}catch(e){this.$router.push("/index/"+t)}}},created:function(){this.routers=this.$router.options.routes[1].children}},L={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"index"},[n("Row",{staticClass:"index",attrs:{type:"flex"}},[n("Col",{staticClass:"navBar",attrs:{span:t.spanLeft}},[n("Menu",{attrs:{theme:"dark","active-name":t.menuActiveName,width:"auto"},on:{"on-select":t.jumpRoute}},[n("div",{staticClass:"logo"},[n("span",[t._v(t._s(t.title))])]),t._v(" "),t._l(t.routers,function(e,a){return e.meta.hidden?t._e():n("MenuItem",{key:e.meta.path,class:{active:!t.isOpen},attrs:{name:e.path}},[n("Tooltip",{attrs:{theme:"",content:e.meta.label,placement:"right",disabled:t.isOpen}},[n("p",{style:t.pWidth},[n("Icon",{class:{active:!t.isOpen},attrs:{type:e.meta.icon,size:t.iconSize}}),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"}]},[t._v(t._s(e.meta.label))])],1)])],1)})],2)],1),t._v(" "),n("Col",{attrs:{span:t.spanRight}},[n("div",{staticClass:"nav"},[n("span",{staticClass:"openButton"},[n("Button",{attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.isOpen=!t.isOpen}}},[n("Icon",{class:{active:!t.isOpen},attrs:{type:"navicon",size:"30"}})],1)],1),t._v(" "),n("tag-pages",{attrs:{tagsActive:t.tagsActive,tags:t.tags},on:{"update:tagsActive":function(e){t.tagsActive=e}}}),t._v(" "),n("span",{staticClass:"avatar"},[n("Dropdown",{attrs:{transfer:""}},[n("Button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"small"}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.username)+"\n\t\t\t\t\t\t\t"),n("Icon",{attrs:{type:"arrow-down-b"}})],1),t._v(" "),n("DropdownMenu",{attrs:{slot:"list",size:"large"},slot:"list"},[n("DropdownItem",{nativeOn:{click:function(e){t.cancelLogin(e)}}},[t._v("退出登录")])],1)],1),t._v(" "),n("Avatar",{attrs:{size:"large",src:"https://i.loli.net/2017/08/21/599a521472424.jpg"}})],1)],1),t._v(" "),n("Row",{attrs:{type:"flex"}},[n("Col",{attrs:{span:"24"}},[n("div",{staticClass:"viewArea"},[n("router-view")],1)])],1)],1)],1)],1)},staticRenderFns:[]},F=n("OF7X")(O,L,!1,function(t){n("TEfj")},null,null).exports,I={data:function(){var t=this;return{columns1:[{title:"Name",key:"name"},{title:"Nick",key:"nick"},{title:"createTime",render:function(t,e){return t("span",o(e.row.createTime))}},{title:"contorl",render:function(e,n){return e("Button",{props:{type:"error",size:"small"},nativeOn:{click:function(){(function(t){return j.post("/admin/user",{id:t})})(n.row._id).then(function(e){t.$Message.success(e.data.msg),t.initData()})}}},"删除")}}],userData:[],total:1}},methods:{initData:function(){var t=this;(function(t){return j.get("/admin/user",{params:{page:t}})})(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1).then(function(e){console.log("res",e),t.total=e.count,t.userData=e.data})}},created:function(){this.initData()}},B={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"user"},[e("Table",{attrs:{columns:this.columns1,data:this.userData}}),this._v(" "),e("div",{staticClass:"center"},[e("Page",{attrs:{total:this.total},on:{"on-change":this.initData}})],1)],1)},staticRenderFns:[]},R=n("OF7X")(I,B,!1,function(t){n("xijz")},null,null).exports,N={data:function(){var t=this;return{productsCol:[{title:"商品图片",width:100,render:function(e,n){return e("img",{attrs:{src:n.row.imgs[0]},on:{click:function(){return t.showImgs(n.row.name,n.row.imgs)}},class:["avatar"]})}},{title:"商品轮播图",width:120,render:function(e,n){return e("img",{attrs:{src:n.row.banner},on:{click:function(){return t.showImgs(n.row.name,n.row.banner)}},class:["avatar"]})}},{title:"启用轮播图",width:120,render:function(e,n){return e("Icon",{props:{type:n.row.showBanner?"checkmark-round":"close-round",color:n.row.showBanner?"#19be6b":"#ed3f14",size:20},class:"bannerSwitch",nativeOn:{click:function(){t.changeBanner(n.row._id,!n.row.showBanner)}}})}},{title:"商品名称",render:function(t,e){return t("Tooltip",{props:{placement:"bottom",transfer:!0}},[t("span",{class:"longText"},e.row.name),t("div",{slot:"content",style:"white-space: normal;"},e.row.name)])}},{title:"商品简介",render:function(t,e){return t("Tooltip",{props:{placement:"bottom",transfer:!0}},[t("span",{class:"longText"},e.row.detail),t("div",{slot:"content",style:"white-space: normal;"},e.row.detail)])}},{title:"商品分类",width:120,key:"tags"},{title:"商品价格",width:120,render:function(t,e){return t("span","￥"+(e.row.price/100).toFixed(2))}},{title:"操作",width:130,render:function(e,n){return e("div",[e("i-button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.$router.push("/index/productEdit/"+n.row._id)}}},"编辑"),e("i-button",{props:{type:"error",size:"small"},on:{click:function(){t.remove(n.row._id)}}},"删除")])}}],productsData:[],imgModal:!1,styleModal:!1,imgData:{},styleCol:[{title:"规格",key:"label"},{title:"库存",key:"count"}],totalPage:1,styleData:[],loading:!1}},methods:{changeBanner:function(t,e){var n=this;(function(t,e){return j.post("/admin/products/banner",{id:t,state:e})})(t,e).then(function(t){n.$Message.success(t.msg),n.initData()}).catch(function(t){n.$Message.error(t.msg)})},remove:function(t){var e=this;(function(t){return j.post("/admin/products/remove",{id:t})})(t).then(function(t){e.$Message.success(t.msg),e.initData()}).catch(function(t){e.$Message.error(t.msg)})},showImgs:function(t,e){"string"==typeof e&&(e=[e]),this.imgData={name:t,imgs:e},this.imgModal=!0},initData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,a().then(function(n){(function(t){return j.get("/admin/products/getList?page="+t)})(e).then(function(e){t.productsData=e.data.map(function(t){return n.data.forEach(function(e){t.tags===e._id&&(t.tags=e.name)}),t}),t.totalPage=e.count,t.loading=!1})})}},created:function(){this.initData()}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"products"},[n("Table",{attrs:{loading:t.loading,columns:t.productsCol,data:t.productsData}}),t._v(" "),n("Modal",{staticStyle:{"text-align":"center"},attrs:{title:t.imgData.name},model:{value:t.imgModal,callback:function(e){t.imgModal=e},expression:"imgModal"}},[t._l(t.imgData.imgs,function(t,e){return n("img",{key:e,staticClass:"img",attrs:{src:t}})}),t._v(" "),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"success"},on:{click:function(e){t.imgModal=!1}}},[t._v("关闭")])],1)],2),t._v(" "),n("Modal",{staticStyle:{"text-align":"center"},attrs:{title:"规格与库存"},model:{value:t.styleModal,callback:function(e){t.styleModal=e},expression:"styleModal"}},[n("Table",{attrs:{columns:t.styleCol,data:t.styleData}}),t._v(" "),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"success"},on:{click:function(e){t.styleModal=!1}}},[t._v("关闭")])],1)],1),t._v(" "),n("div",{staticClass:"center"},[n("Page",{attrs:{total:t.totalPage},on:{"on-change":t.initData}})],1)],1)},staticRenderFns:[]},V=n("OF7X")(N,E,!1,function(t){n("scA5")},null,null).exports,A=n("3cXf"),U=n.n(A),q={data:function(){return{showProgress:!1,percentage:0,imgName:"",visible:!1,uploadList:[]}},watch:{imgs:{deep:!0,handler:function(t){this.uploadList=t}}},props:{imgs:{type:Array,required:!0},maxSize:{type:Number,required:!0},type:{type:String,required:!1,default:"avatar"}},methods:{handleView:function(t){this.imgName=t,this.visible=!0},handleRemove:function(t){this.uploadList.splice(t,1),this.$emit("update:imgs",this.uploadList)},handleSuccess:function(t){5005===t.code&&(this.$Message.error("请先登录"),sessionStorage.clear(),this.$router.push("/")),this.uploadList.push(t),this.$emit("update:imgs",this.uploadList)},handleFormatError:function(t){this.$Notice.warning({title:"文件格式错误",desc:"只能上传 jpg 或者 png 图片！"})},handleMaxSize:function(t){this.$Notice.warning({title:"超出大小限制",desc:"不能上传超过 2M 的图片"})},handleBeforeUpload:function(){var t=this.uploadList.length<this.maxSize;return t||this.$Notice.warning({title:"最多上传"+this.maxSize+"张图片！"}),t}}},X={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"uploadImg"},[t._l(t.uploadList,function(e,a){return n("div",{key:e.url,class:"avatar"===t.type?"demo-upload-list":"demo-upload-list banner"},[n("Spin",{staticClass:"loadingIcon",attrs:{size:"small"}}),t._v(" "),n("img",{attrs:{src:e}}),t._v(" "),n("div",{staticClass:"demo-upload-list-cover"},[n("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(n){t.handleView(e)}}}),t._v(" "),n("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(e){t.handleRemove(a)}}})],1)],1)}),t._v(" "),n("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"on-success":t.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.handleBeforeUpload,multiple:"",type:"drag",action:"/admin/uploadImg"}},[n("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[n("Icon",{attrs:{type:"camera",size:"20"}})],1)]),t._v(" "),n("Modal",{attrs:{title:"View Image"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?n("img",{staticStyle:{width:"100%"},attrs:{src:t.imgName}}):t._e()])],2)},staticRenderFns:[]},J={data:function(){return{loading:!1,tags:[],formData:{name:"",tags:"",detail:"",price:"",imgs:[],banner:[]},rules:{name:[{required:!0,message:"商品名称不能为空",trigger:"blur"}],tags:[{required:!0,message:"商品分类不能为空",trigger:"blur"}],detail:[{required:!0,message:"商品介绍不能为空",trigger:"blur"}],price:[{required:!0,type:"number",min:1,message:"商品价格单位为分且只能为数字",trigger:"blur"}],banner:[{required:!0,type:"array",message:"商品轮播图不能为空",trigger:"blur"}]}}},methods:{subForm:function(){var t=this;this.$refs.products.validate(function(e){if(e){t.loading=!0;var n=function(e){for(var n=arguments.length,a=Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return e.apply(void 0,a).then(function(e){t.$Message.success(e.msg),t.$router.push("/index/products")}).catch(function(e){t.loading=!1,t.$Message.error(e.msg)})},a=JSON.parse(U()(t.formData));a.banner=a.banner[0],t.$route.params.id?n(c,a):n(l,a)}else t.$Message.error("请完善所有信息!")})},loadTags:function(){var t=this;this.$store.dispatch("tags/getTags").then(function(){t.tags=t.$store.getters["tags/getTags"]})}},created:function(){var t=this;this.$route.params.id&&(this.loading=!0,function(t){return j.get("/admin/products/findOne?id="+t)}(this.$route.params.id).then(function(e){e.data.banner=[e.data.banner],t.formData=e.data,t.loading=!1}).catch(function(e){t.$Message.error(e.msg),t.loading=!1})),this.loadTags()},components:{uploadImg:n("OF7X")(q,X,!1,function(t){n("3Y14")},null,null).exports}},P={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"publishProducts"},[t.loading?n("Spin",{attrs:{size:"large",fix:""}}):t._e(),t._v(" "),n("Form",{ref:"products",attrs:{model:t.formData,rules:t.rules}},[n("FormItem",{attrs:{label:"商品名称：",prop:"name"}},[n("Input",{attrs:{placeholder:"请输入商品名称"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),n("FormItem",{attrs:{label:"商品分类：",prop:"tags"}},[n("Select",{attrs:{placeholder:"请选择商品分类"},model:{value:t.formData.tags,callback:function(e){t.$set(t.formData,"tags",e)},expression:"formData.tags"}},[0===t.tags.length?n("Option",{attrs:{value:""}},[t._v("暂无分类，请先去分类管理添加分类!")]):t._l(t.tags,function(e){return n("Option",{key:e._id,attrs:{value:e._id}},[t._v(t._s(e.name))])})],2)],1),t._v(" "),n("FormItem",{attrs:{label:"商品介绍：",prop:"detail"}},[n("Input",{attrs:{placeholder:"请输入商品介绍",type:"textarea",autosize:{minRows:2,maxRows:3}},model:{value:t.formData.detail,callback:function(e){t.$set(t.formData,"detail",e)},expression:"formData.detail"}})],1),t._v(" "),n("FormItem",{attrs:{label:"商品价格(分)：",prop:"price"}},[n("Input",{attrs:{placeholder:"请输入商品价格",number:""},model:{value:t.formData.price,callback:function(e){t.$set(t.formData,"price",e)},expression:"formData.price"}})],1),t._v(" "),n("FormItem",{attrs:{label:"商品图片：",prop:"imgs"}},[n("upload-img",{attrs:{imgs:t.formData.imgs,type:"avatar",maxSize:6},on:{"update:imgs":function(e){t.$set(t.formData,"imgs",e)}}})],1),t._v(" "),n("FormItem",{attrs:{label:"商品轮播图：",prop:"banner"}},[n("upload-img",{attrs:{imgs:t.formData.banner,type:"banner",maxSize:1},on:{"update:imgs":function(e){t.$set(t.formData,"banner",e)}}})],1)],1),t._v(" "),n("Button",{staticClass:"sub",attrs:{type:"success",loading:t.loading},on:{click:function(e){e.stopPropagation(),t.subForm(e)}}},[t._v("发布")])],1)},staticRenderFns:[]},W=n("OF7X")(J,P,!1,function(t){n("Yl6/")},null,null).exports,Y={data:function(){var t=this;return{showModal:!1,formData:{name:""},columns1:[{title:"Name",key:"name"},{title:"Create Time",key:"createTime"},{title:"操作",render:function(e,n){return e("div",[e("i-button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.edit(n.row)}}},"编辑"),e("i-button",{props:{type:"error",size:"small"},on:{click:function(){t.remove(n.row._id)}}},"删除")])}}],tagList:[]}},methods:{cancelModal:function(t){t||(this.showModal=!1,this.formData.name="")},subTags:function(){var t=this,e="tags/add";this.formData._id&&(e="tags/edit"),this.$store.dispatch(e,this.formData).then(function(e){t.$Message.success(e.msg),t.formData.name="",t.initData()}).catch(function(e){t.$Message.error(e),t.formData.name=""}),this.showModal=!1},edit:function(t){this.formData=JSON.parse(U()(t)),this.showModal=!0},remove:function(t){var e=this;this.$store.dispatch("tags/remove",t).then(function(t){e.$Message.success(t.msg),e.initData()})},initData:function(){var t=this;this.$store.dispatch("tags/getTags").then(function(){t.tagList=t.$store.getters["tags/getTags"]})}},created:function(){this.initData()}},Q={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"classify"},[n("header",[n("Button",{attrs:{type:"success"},on:{click:function(e){e.stopPropagation(),t.showModal=!0}}},[t._v("添加分类")])],1),t._v(" "),n("Table",{attrs:{columns:t.columns1,data:t.tagList}}),t._v(" "),n("Modal",{attrs:{title:"分类信息"},on:{"on-ok":t.subTags,"on-cancel":t.cancelModal,"on-visible-change":t.cancelModal},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[n("Input",{on:{"on-enter":t.subTags},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1)],1)},staticRenderFns:[]},K=n("OF7X")(Y,Q,!1,function(t){n("Vdd3")},null,null).exports,H=(n("phW1"),{data:function(){var t=this;return{columns:[{title:"用户名",key:"user"},{title:"收货地址",render:function(e,n){return e("Button",{props:{type:"primary",size:"small"},nativeOn:{click:function(){(function(t){return j.get("/admin/order/address",{params:{id:t}})})(n.row.address).then(function(e){t.addressData=[e.address],t.addressVisible=!0})}}},"查看")}},{title:"状态",render:function(t,e){return t("span",0===e.row.state?"已发货":"已完成")}},{title:"商品快照",render:function(e,n){return e("Button",{props:{type:"primary",size:"small"},nativeOn:{click:function(){(function(t){return j.post("/admin/order/snapShoot",{arr:t})})(n.row.snapShoot).then(function(e){t.snapData=e.data,t.snapVisible=!0})}}},"查看")}},{title:"操作",render:function(e,n){return e("Button",{props:{type:"error",size:"small"},nativeOn:{click:function(){t.removeOrder(n.row._id)}}},"删除")}}],snapColumns:[{title:"商品图片",render:function(t,e){return t("img",{attrs:{src:e.row.img},style:"width: 50px;"})}},{title:"商品名称",key:"name"},{title:"商品单价",render:function(t,e){return t("span","￥"+(e.row.price/100).toFixed(2))}},{title:"商品数量",key:"count"},{title:"商品总价",render:function(t,e){return t("span","￥"+(e.row.price*e.row.count/100).toFixed(2))}}],addressColumns:[{title:"收货人",key:"name"},{title:"联系方式",key:"phone"},{title:"区域",render:function(t,e){return t("span",e.row.address[0])}},{title:"详细地址",key:"detail"}],total:0,loading:!1,formData:[],snapVisible:!1,snapData:[],addressVisible:!1,addressData:[]}},methods:{removeOrder:function(t){var e=this;(function(t){return j.post("/admin/order/remove",{id:t})})(t).then(function(t){e.$Message.success(t.msg),e.initData()})},initData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,function(t){return j.get("/admin/order",{params:{page:t}})}(e).then(function(e){t.total=e.count,t.formData=e.data,t.loading=!1})}},created:function(){this.initData()}}),G={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"order"},[t.loading?n("Spin",{attrs:{fix:""}}):t._e(),t._v(" "),n("Table",{attrs:{columns:t.columns,data:t.formData}}),t._v(" "),n("Modal",{attrs:{width:"70"},model:{value:t.snapVisible,callback:function(e){t.snapVisible=e},expression:"snapVisible"}},[n("Table",{attrs:{columns:t.snapColumns,data:t.snapData}})],1),t._v(" "),n("Modal",{attrs:{width:"70"},model:{value:t.addressVisible,callback:function(e){t.addressVisible=e},expression:"addressVisible"}},[n("Table",{attrs:{columns:t.addressColumns,data:t.addressData}})],1),t._v(" "),n("div",{staticClass:"center"},[n("Page",{attrs:{total:t.total},on:{"on-change":t.initData}})],1)],1)},staticRenderFns:[]},Z=n("OF7X")(H,G,!1,function(t){n("hTyi")},null,null).exports;u.default.use(m.a);var tt=new m.a({routes:[{path:"/",name:"login",component:$},{path:"/index",name:"index",redirect:"/index/user",component:F,meta:{icon:"xx",label:"首页",hidden:!0},children:[{path:"user",name:"user",component:R,meta:{icon:"person",label:"用户管理",hidden:!1}},{path:"products",name:"products",component:V,meta:{icon:"ionic",label:"商品管理",hidden:!1}},{path:"productEdit/:id",component:W,meta:{icon:"navigate",label:"商品编辑",hidden:!0}},{path:"productEdit",name:"productEdit",component:W,meta:{icon:"navigate",label:"商品发布",hidden:!1}},{path:"classify",name:"classify",component:K,meta:{icon:"pricetag",label:"分类管理",hidden:!1}},{path:"order",name:"order",component:Z,meta:{icon:"android-list",label:"订单管理",hidden:!1}}]}]});tt.beforeEach(function(t,e,n){sessionStorage.user?"/"===t.path?z.dispatch("pression/checkLogin",sessionStorage.user).then(function(){f.Message.error("请勿重复登录"),n("/index")}):n():"/"===t.path?n():(f.Message.error("请先登录"),n("/"))});var et=tt;n("vjum");u.default.config.productionTip=!1,u.default.use(h.a),new u.default({el:"#app",router:et,store:z,template:"<App/>",components:{App:p}})},TEfj:function(t,e,n){var a=n("KGJy");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("9f8e3cde",a,!0)},VLGk:function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,".products{width:100%}.products .avatar{width:50px}.products .longText{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:inline-block;width:210px}.products .center{background-color:#fff;position:fixed;padding:10px;bottom:0;width:100%}.products .bannerSwitch{cursor:pointer}.img{width:100%;margin:0 5px}",""])},Vdd3:function(t,e,n){var a=n("Hlp6");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("270a41ce",a,!0)},WDpv:function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,".ivu-col{margin-bottom:0;border-top:1px solid #ddd}.textCenter,.title{text-align:center}.title{font-size:14px;font-weight:700;background-color:#f5f5f5}.title .ivu-col{height:40px;line-height:40px}.noMt{margin:0}.borderL{border-left:1px solid #ddd}.borderR{border-right:1px solid #ddd}.center{background-color:#fff;position:fixed;padding:10px;bottom:0;width:100%}",""])},"Yl6/":function(t,e,n){var a=n("Bl8r");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("50c6779a",a,!0)},eZMP:function(t,e,n){var a=n("ux8m");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("5bab0a52",a,!0)},hTyi:function(t,e,n){var a=n("WDpv");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("2f28e4f0",a,!0)},muez:function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,'.login{width:100%;height:100%;background:#2d3a4b url("/admin/login_bg.jpg") 0 0/cover no-repeat}.login h2{margin-bottom:20px}.login .ivu-card{position:fixed;right:10%;width:320px;top:50%;-webkit-transform:translateY(-70%);transform:translateY(-70%)}.login .ivu-card .ivu-card-body{padding-bottom:0}.login .ivu-form-item{margin-bottom:20px}',""])},qidL:function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,".tags{padding-left:10px;width:calc(100% - 190px);overflow:hidden}.tags>div{float:left;white-space:nowrap;-webkit-transform:translateX(0);transform:translateX(0);-webkit-transition:-webkit-transform .2s ease-out;transition:-webkit-transform .2s ease-out;transition:transform .2s ease-out;transition:transform .2s ease-out,-webkit-transform .2s ease-out}",""])},scA5:function(t,e,n){var a=n("VLGk");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("74f54ad2",a,!0)},ux8m:function(t,e,n){(t.exports=n("BkJT")(void 0)).push([t.i,"html{overflow:hidden}html,html body,html body #app{width:100%;height:100%}",""])},vjum:function(t,e){},wQsu:function(t,e,n){var a=n("qidL");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("c5a5c09c",a,!0)},xijz:function(t,e,n){var a=n("6UKm");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("189640ee",a,!0)}},["NHnr"]);
//# sourceMappingURL=app.765e9645d5d9b27c125d.js.map